# From Pockets to Products  
### A Data-Driven Framework for Classification of Monoterpene Synthase Product Preferences
**Authors:** Cathal Ó Raghallaigh, Nigel S. Scrutton, Sam Hay  
**Affiliation:** Manchester Institute of Biotechnology, The University of Manchester 

[![DOI](https://img.shields.io/badge/DOI-10.26434%2Fchemrxiv--2025--mf4xs-brightgreen.svg)](https://doi.org/10.26434/chemrxiv-2025-mf4xs)


<img width="3862" height="1396" alt="Picture8" src="https://github.com/user-attachments/assets/52767163-5c5c-4168-a85f-185295d26b69" />

## Overview  
This repository provides all datasets and notebooks used in the ChemRxiv preprint *“From Pockets to Products: A Data-Driven Framework for Classification of Monoterpene Synthase Product Preferences.”*  
The project integrates **structural bioinformatics** and **machine learning** to predict whether monoterpene synthases produce **linear or cyclic** products using sequence- and structure-derived features.  

---

## Notebooks and Datasets  

| Notebook / Dataset | Description | Includes |
|--------------------|-------------|-----------|
| `CharacterisedSeqRef.csv` | Reference table of characterised sequences. | UniProt/GenBank accessions, enzyme names, product class. |
| `FullDataset.csv` | Full dataset of 88 characterised monoterpene synthases with active-site features. | Raw features for model training and selection. |
| `TestTrainSet.csv` | Train-test partition, used for trainining of models. | 80% of full dataset. |
| `ValidationSet.csv` | Independent validation dataset, used for assessing generalisation. | 20% of full dataset. |
| `StatsScript.ipynb` | Statistical comparison of feature distributions between classes. | t-tests, significance ranking, visual summaries. |
| `StrucResCons.ipynb` | Structure-based residue conservation analysis. Aligns multiple models to a reference and identifies spatially corresponding residues. | Structural alignment, conservation scoring, residue mapping, logo generation. |
| `BOXGBoost.ipynb` | Bayesian optimisation of XGBoost hyperparameters and feature-group subsets. | Feature group addition, accuracy tracking, convergence plots. |
| `BayesianOut.csv` | Output from Bayesian optimisation for feature set reduction | Model confidence and feature sets included |
| `TestTrainEval.ipynb` | Trains and evaluates models using different feature sets on the test-train split data (80%) | Accuracy, confusion matrices, feature importance. |
| `LogLoss.ipynb` | Tracks and visualises log-loss across iterations for Bayesian optimised feature set and the full feature set, to assess convergence and overfitting. | Per-iteration log-loss, convergence curves, summary statistics. |
| `TestOnValidation.ipynb` | Trains and tests final models on an independent validation dataset containing unseen enzymes. | Validation metrics, misclassification tables, confusion matrices. |
| `PreprintExtraLinLim.csv` | Additional linalool and limonene synthases from **Samusevich *et al.* (2024)**. | Extended validation. |
| `PreprintExtraLinLimData.csv` | Processed structural and physicochemical data for the above. | Extended validation with data extracted. |
| `TestOnPluskalDataset.ipynb` | External validation using **Samusevich *et al.* (2024)**, *bioRxiv* [2024.01.29.577750](https://doi.org/10.1101/2024.01.29.577750). | Benchmarking against unseen Pluskal Lab data. |
| `Structures/` | Structures of all monoterpene synthases used in the study. | PDB files for all models, including folder 'Pockets', of active site pockets generated by FPocket |

---

## Installation Options

**Option 1: Conda**
```bash
conda env create -f environment.yml
conda activate mtsenv

```
**Option 2: Pip**
```bash
pip install -r requirements.txt
```

## Citation

If you use this repository or data, please cite:

Ó Raghallaigh, C. (2025). From Pockets to Products: A Data-Driven Framework for Classification of Monoterpene Synthase Product Preferences. ChemRxiv. https://doi.org/10.26434/chemrxiv-2025-mf4xs

## License

This project is licensed under the MIT License.
You are free to use, modify, and distribute this work with appropriate attribution.
See the [LICENSE](./LICENSE) file for full terms.
